# ============================================================================
# REEL TWEET RENDER API - Environment Configuration
# ============================================================================
# Copy this file to .env and configure the values for your environment.
# Default values are provided for quick local development.
# ============================================================================

# ----------------------------------------------------------------------------
# SERVER CONFIGURATION
# ----------------------------------------------------------------------------

# Port the server will listen on
# Default: 3000
PORT=3000

# Node environment: development, production, test
# Default: development
# In production, enables optimizations and disables verbose logging
NODE_ENV=development

# Base URL for generating download links
# This should be your public API URL (e.g., https://api.example.com)
# Used to generate full download URLs for rendered videos
# ⚠️ IMPORTANT: In production (Railway), set this to your Railway app URL!
# Examples:
#   Production: https://your-app.railway.app
#   Custom domain: https://api.yourdomain.com
#   Local dev: http://localhost:3000
# Format: No trailing slash
BASE_URL=http://localhost:3000

# ----------------------------------------------------------------------------
# SECURITY CONFIGURATION
# ----------------------------------------------------------------------------

# HMAC secret for request signature verification
# REQUIRED: Generate a secure random string (minimum 32 characters)
# Use a cryptographically secure random generator
# Example generation: openssl rand -hex 32
# WARNING: Keep this secret! Never commit to version control
HMAC_SECRET=your-super-secret-hmac-key-min-32-chars-change-this-in-production

# ----------------------------------------------------------------------------
# CHROME/CHROMIUM CONFIGURATION
# ----------------------------------------------------------------------------

# Path to Chrome/Chromium executable
# Leave empty for automatic detection
# Automatic detection order:
#   1. PUPPETEER_EXECUTABLE_PATH environment variable
#   2. System Chrome/Chromium installations
#   3. Bundled Chromium from Puppeteer
#
# Common paths:
#   macOS: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
#   Linux: /usr/bin/chromium or /usr/bin/google-chrome
#   Docker: /usr/bin/chromium
#   Windows: C:\Program Files\Google\Chrome\Application\chrome.exe
#
# Default: Auto-detect
PUPPETEER_EXECUTABLE_PATH=

# ----------------------------------------------------------------------------
# FFMPEG CONFIGURATION
# ----------------------------------------------------------------------------

# Path to FFmpeg executable
# Leave empty for automatic detection
# Automatic detection order:
#   1. FFMPEG_PATH environment variable
#   2. System PATH lookup
#   3. Common installation paths
#
# Common paths:
#   macOS (Homebrew): /opt/homebrew/bin/ffmpeg or /usr/local/bin/ffmpeg
#   Linux: /usr/bin/ffmpeg
#   Docker: /usr/bin/ffmpeg
#   Windows: C:\ffmpeg\bin\ffmpeg.exe
#
# Default: Auto-detect
FFMPEG_PATH=

# ----------------------------------------------------------------------------
# STORAGE CONFIGURATION
# ----------------------------------------------------------------------------

# Storage provider type
# Options: local (more providers can be added in the future: s3, gcs, azure)
# Default: local
STORAGE_PROVIDER=local

# Path to storage directory
# For local storage, this is where video files will be saved
# For Railway/Docker deployments, mount a volume to this path
# IMPORTANT: Must have write permissions
# Default: /data/videos
STORAGE_PATH=/data/videos

# Time-to-live (TTL) for stored files in hours
# Files older than this will be automatically cleaned up
# Recommended: 24-72 hours for temporary video generation
# Set to 0 to disable automatic expiration (not recommended)
# Default: 24
STORAGE_TTL_HOURS=24

# Maximum file size in megabytes (MB)
# Videos exceeding this size will be rejected
# Recommended: 50-100 MB for short video clips
# Default: 100
STORAGE_MAX_FILE_SIZE_MB=100

# Cleanup interval in minutes
# How often to run automatic cleanup of expired files
# Recommended: 30-60 minutes
# Default: 60
CLEANUP_INTERVAL_MINUTES=60

# ----------------------------------------------------------------------------
# VIDEO GENERATION CONFIGURATION
# ----------------------------------------------------------------------------

# Default video duration in seconds
# How long the rendered video will be
# Recommended: 5-15 seconds for social media
# Default: 5
VIDEO_DURATION=5

# Video width in pixels
# Standard formats:
#   - 1080 (1080x1920) - Instagram/TikTok Portrait
#   - 1920 (1920x1080) - YouTube Landscape
#   - 720 (720x1280) - Lower quality portrait
# Default: 1080
VIDEO_WIDTH=1080

# Video height in pixels
# Must match aspect ratio with width
# Common aspect ratios:
#   - 9:16 (Portrait): 1080x1920, 720x1280
#   - 16:9 (Landscape): 1920x1080, 1280x720
# Default: 1920
VIDEO_HEIGHT=1920

# Video frames per second (FPS)
# Higher FPS = smoother video but larger file size
# Recommended: 24-30 for social media
# Options: 24, 25, 30, 60
# Default: 30
VIDEO_FPS=30

# Audio volume level
# Range: 0.0 (mute) to 2.0 (200% volume)
# Recommended: 0.2-0.5 for background music
# Default: 0.3
AUDIO_VOLUME=0.3

# Fade in/out duration in seconds
# Visual and audio fade effects at start and end
# Recommended: 0.3-1.0 seconds
# Set to 0 to disable fades
# Default: 0.5
FADE_DURATION=0.5

# ----------------------------------------------------------------------------
# WORKER CONFIGURATION
# ----------------------------------------------------------------------------

# Maximum number of concurrent video generation jobs
# Controls how many videos can be processed simultaneously
# Higher values = more parallelism but more resource usage
# Recommended: 2-5 for typical deployments
# IMPORTANT: Consider your server's CPU and memory capacity
# Default: 3
MAX_CONCURRENT_JOBS=3

# Job retention time in hours
# How long to keep completed/failed job records in memory
# After this time, job history is cleaned up
# Recommended: 24-72 hours
# Default: 72
JOB_CLEANUP_HOURS=72

# Worker polling interval in milliseconds
# How often workers check for new jobs
# Lower = more responsive but more CPU usage
# Higher = less CPU usage but slower job pickup
# Recommended: 100-1000 ms
# Default: 500
WORKER_POLL_INTERVAL_MS=500

# ----------------------------------------------------------------------------
# ASSET PATHS
# ----------------------------------------------------------------------------

# Path to background music file
# Absolute path to the audio file to use in videos
# Supported formats: MP3, WAV, AAC, M4A, OGG
# Leave empty if you don't want background music
# Example: /app/assets/background-music.mp3
# Default: none (silent video)
BACKGROUND_MUSIC_PATH=

# Path to tweet template HTML file
# Absolute path to the HTML template for rendering tweets
# The template must include placeholders: {{theme}}, {{profilePhotoUrl}},
# {{profileName}}, {{username}}, {{tweetBody}}, {{timestamp}}
# Default: ./claude/twitter-post-template.html
TWEET_TEMPLATE_PATH=./claude/twitter-post-template.html

# ----------------------------------------------------------------------------
# LOGGING CONFIGURATION (Optional)
# ----------------------------------------------------------------------------

# Log level for application logging
# Options: error, warn, info, debug, trace
# Default: info
# LOG_LEVEL=info

# Enable structured JSON logging
# Set to true for production deployments (easier to parse)
# Set to false for human-readable console logs in development
# Default: false
# LOG_JSON=false

# ----------------------------------------------------------------------------
# PERFORMANCE TUNING (Advanced)
# ----------------------------------------------------------------------------

# Screenshot quality (0-100)
# Higher quality = larger file sizes but better visual fidelity
# Default: 90
# SCREENSHOT_QUALITY=90

# Enable hardware acceleration for Puppeteer
# Set to false if running in Docker without GPU access
# Default: false
# PUPPETEER_HARDWARE_ACCELERATION=false

# Puppeteer timeout in milliseconds
# Maximum time to wait for page rendering
# Default: 30000 (30 seconds)
# PUPPETEER_TIMEOUT=30000

# ----------------------------------------------------------------------------
# CORS CONFIGURATION (Optional)
# ----------------------------------------------------------------------------

# Allowed origins for CORS (comma-separated)
# Use * for all origins (not recommended for production)
# Example: https://example.com,https://app.example.com
# Default: * (allow all)
# CORS_ORIGINS=*

# ----------------------------------------------------------------------------
# RATE LIMITING (Optional)
# ----------------------------------------------------------------------------

# Enable rate limiting
# Default: false
# RATE_LIMIT_ENABLED=false

# Maximum requests per window
# Default: 100
# RATE_LIMIT_MAX_REQUESTS=100

# Rate limit window in minutes
# Default: 15
# RATE_LIMIT_WINDOW_MINUTES=15

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================
#
# RAILWAY DEPLOYMENT:
# 1. Create a volume in Railway dashboard
# 2. Mount point: /data
# 3. Set STORAGE_PATH=/data/videos
# 4. Set PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium (auto-detected from Dockerfile)
# 5. Set FFMPEG_PATH=/usr/bin/ffmpeg (auto-detected from Dockerfile)
# 6. Generate secure HMAC_SECRET: openssl rand -hex 32
# 7. Set BASE_URL to your Railway public URL
#
# DOCKER DEPLOYMENT:
# 1. Mount a volume to /data for persistence
# 2. Chromium and FFmpeg paths are pre-configured in Dockerfile
# 3. Ensure NODE_ENV=production for optimal performance
# 4. Set BASE_URL to your public domain
#
# PRODUCTION CHECKLIST:
# - [ ] Generate and set a secure HMAC_SECRET (minimum 32 characters)
# - [ ] Set correct BASE_URL for your deployment
# - [ ] Configure storage volume/path with write permissions
# - [ ] Set NODE_ENV=production
# - [ ] Verify STORAGE_TTL_HOURS for your use case
# - [ ] Test Chromium and FFmpeg paths (should auto-detect)
# - [ ] Set MAX_CONCURRENT_JOBS based on server resources
# - [ ] Configure CORS_ORIGINS if restricting access
# - [ ] Set up monitoring and health checks
# - [ ] Enable structured logging (LOG_JSON=true)
#
# ============================================================================
